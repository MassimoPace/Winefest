<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Secret Draw ‚Äî Country & Style</title>
<style>
:root{
  --bg:#0f1221; --card:#171a2b; --ink:#e9ecff; --muted:#aab0d6; --accent:#7aa2ff; --accent-2:#9ef0c3;
  --radius:14px; --radius-sm:10px; --shadow: 0 10px 30px rgba(0,0,0,.35), 0 1px 0 rgba(255,255,255,.05) inset;
}
body{
  margin:0; font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  color:var(--ink); background:radial-gradient(1000px 600px at 20% -10%, #1b2150 0%, transparent 60%),
                     radial-gradient(800px 500px at 100% 0%, #1a3e34 0%, transparent 60%), var(--bg);
  display:flex; align-items:center; justify-content:center; padding:24px;
}
.wrap{width:min(980px,100%); display:grid; gap:18px}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); box-shadow:var(--shadow);
  padding:22px;
}
.title{font-size:24px; font-weight:700; margin:0 0 6px}
.subtitle{color:var(--muted); margin:0 0 14px}
textarea,input{width:100%; padding:12px 14px; border-radius:var(--radius-sm); border:1px solid rgba(255,255,255,.08);
  background:#111426; color:var(--ink); outline:none}
textarea{min-height:120px; resize:vertical}
.row{display:flex; gap:12px; flex-wrap:wrap}
.btn{padding:12px 16px; border-radius:12px; font-weight:700; cursor:pointer; border:0;
  background:linear-gradient(90deg, var(--accent) 0%, #9d8cff 100%); color:#0b0f20}
.btn.secondary{background:#202546; color:var(--ink); border:1px solid rgba(255,255,255,.1)}
.copy{padding:8px 10px; border-radius:10px; background:#0f1430; color:var(--ink); border:1px solid rgba(255,255,255,.12); cursor:pointer}
.list{display:grid; gap:10px}
.link-item{display:flex; align-items:center; gap:12px; padding:12px; border-radius:10px; background:#12162c; border:1px dashed rgba(255,255,255,.12)}
.tip{color:var(--muted); font-size:14px}
.center{text-align:center; display:flex; flex-direction:column; gap:12px; align-items:center}
.big{font-size:28px; font-weight:800; margin:6px 0}
.reveal{padding:14px 22px; border-radius:14px; background:linear-gradient(90deg, var(--accent-2), #c5f9e9); font-weight:900; border:0; cursor:pointer}
.hidden{display:none !important}
/* Drum animation */
@keyframes drumHit {
  0% { transform: translateY(0px) rotate(0deg); }
  25% { transform: translateY(-10px) rotate(-5deg); }
  50% { transform: translateY(0px) rotate(0deg); }
  75% { transform: translateY(-10px) rotate(5deg); }
  100% { transform: translateY(0px) rotate(0deg); }
}
#drum.animate { animation: drumHit 0.2s infinite; }
/* Fade-in */
#result.fade-in, #countdown.fade-in { opacity:0; animation:fadeIn 0.5s forwards; }
@keyframes fadeIn { to{opacity:1;} }
</style>
</head>
<body>
<div class="wrap">

<!-- SETUP -->
<section id="setup" class="card">
<h1 class="title">Secret Draw ‚Äî Country & Style</h1>
<p class="subtitle">Enter two lists, one for countries and one for styles. Generate private links so each person gets a secret pair.</p>
<label>Countries (one per line)</label>
<textarea id="countriesInput" placeholder="Japan&#10;Italy&#10;Brazil"></textarea>
<label>Styles (one per line)</label>
<textarea id="stylesInput" placeholder="Minimalist&#10;Baroque&#10;Futuristic"></textarea>
<div class="row" style="margin-top:12px">
<button class="btn" id="genBtn">Generate draw links</button>
</div>
</section>

<!-- LINKS -->
<section id="links" class="card hidden">
<h2 class="title">Your draw links</h2>
<p class="subtitle" id="linksSubtitle"></p>
<div id="linksList" class="list"></div>
<div class="row" style="margin-top:14px">
<button class="btn secondary" id="backBtn">‚Üê Back</button>
<button class="btn" id="copyAllBtn">Copy all links</button>
</div>
</section>

<!-- DRAW -->
<section id="draw" class="card hidden">
<div class="center">
<h2 id="drawMsg" class="subtitle"></h2>
<div id="countdown" class="big hidden">3</div>
<div id="drumContainer" class="center hidden">
<img id="drum" src="https://upload.wikimedia.org/wikipedia/commons/8/87/Tom-tom_drum.png" alt="Drum" style="width:120px;height:120px;">
<p class="tip">Drumroll‚Ä¶</p>
</div>
<button id="revealBtn" class="reveal">Reveal my draw</button>
<div id="result" class="hidden"></div>
<button id="copyResultBtn" class="copy hidden">Copy my result</button>
</div>
<audio id="suspenseAudio" src="https://cdn.pixabay.com/download/audio/2022/02/15/audio_678f82049d.mp3?filename=suspense-ambient-112.mp3" preload="auto"></audio>
</section>

</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
const $ = s=>document.querySelector(s);
const $$ = s=>document.querySelectorAll(s);

function toLines(s){return s.split(/\r?\n/).map(x=>x.trim()).filter(Boolean);}
function shuffle(arr){return arr.sort(()=>Math.random()-0.5);}

const genBtn = $('#genBtn'), backBtn=$('#backBtn'), copyAllBtn=$('#copyAllBtn');
const setupView=$('#setup'), linksView=$('#links'), linksList=$('#linksList'), linksSubtitle=$('#linksSubtitle');
const drawView = $('#draw'), countdown=$('#countdown'), drumContainer=$('#drumContainer');
const revealBtn=$('#revealBtn'), result=$('#result'), copyResultBtn=$('#copyResultBtn'), suspense=$('#suspenseAudio');

genBtn.onclick = ()=>{
  const countries=toLines($('#countriesInput').value);
  const styles=toLines($('#stylesInput').value);
  if(countries.length!==styles.length || countries.length===0){alert('Lists must have same non-zero length'); return;}
  const shuffledC = shuffle([...countries]);
  const shuffledS = shuffle([...styles]);
  linksList.innerHTML=''; 
  linksSubtitle.textContent=`Created ${shuffledC.length} links. Share one per person.`;
  shuffledC.forEach((c,i)=>{
    const s=shuffledS[i];
    const frag=encodeURIComponent(JSON.stringify({country:c,style:s}));
    const url=location.origin+location.pathname+'#'+frag;
    const row=document.createElement('div'); row.className='link-item';
    const lbl=document.createElement('div'); lbl.textContent=`Link ${i+1}`;
    const open=document.createElement('a'); open.href=url; open.target='_blank'; open.className='btn secondary'; open.textContent='Open';
    const copyBtn=document.createElement('button'); copyBtn.className='copy'; copyBtn.textContent='Copy'; copyBtn.onclick=()=>navigator.clipboard.writeText(url);
    row.append(lbl,copyBtn,open); linksList.appendChild(row);
  });
  copyAllBtn.onclick = ()=>{navigator.clipboard.writeText(Array.from(linksList.querySelectorAll('a')).map(a=>a.href).join('\n'))};
  setupView.classList.add('hidden'); linksView.classList.remove('hidden');
};
backBtn.onclick = ()=>{linksView.classList.add('hidden'); setupView.classList.remove('hidden');};

function initDraw(){
  if(!location.hash) return;
  try{
    const data=JSON.parse(decodeURIComponent(location.hash.slice(1)));
    linksView.classList.add('hidden'); setupView.classList.add('hidden'); drawView.classList.remove('hidden');
    revealBtn.onclick = ()=>{
      revealBtn.disabled=true;
      countdown.classList.remove('hidden'); countdown.textContent='3';
      drumContainer.classList.remove('hidden'); $('#drum').classList.add('animate');
      suspense.play();
      let count=3;
      const interval=setInterval(()=>{
        count--; if(count>0) countdown.textContent=count;
        else{
          clearInterval(interval);
          countdown.classList.add('hidden'); drumContainer.classList.add('hidden'); $('#drum').classList.remove('animate');
          result.textContent=`üéâ ${data.country} ‚Äî ${data.style} üéâ`;
          result.classList.remove('hidden'); result.classList.add('fade-in');
          copyResultBtn.classList.remove('hidden'); 
          copyResultBtn.onclick=()=>navigator.clipboard.writeText(`${data.country} ‚Äî ${data.style}`);
          confetti({particleCount:100, spread:70, origin:{y:0.6}});
        }
      },1000);
    }
  }catch(e){console.log('Invalid draw hash',e);}
}
initDraw();
</script>
</body>
</html>
